from django.db.models import CharField, Model, TextField, DateTimeField, Index

from application.core.types import ExploitSource


class Exploit(Model):
    vulnerability_id = CharField(max_length=255)
    url = TextField(max_length=2048)
    source = CharField(max_length=16, choices=ExploitSource.EXPLOIT_SOURCE_CHOICES)
    source_id = CharField(max_length=255, blank=True)
    created = DateTimeField(auto_now_add=True)

    class Meta:
        indexes = [
            Index(fields=["vulnerability_id", "-created"]),
            Index(fields=["-created"]),
        ]
        ordering = ["vulnerability_id", "-created"]